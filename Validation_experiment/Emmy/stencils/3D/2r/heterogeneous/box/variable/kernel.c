void kernel_loop(double *a, double *b, double *W, int M, int P, int N)
{
  #pragma omp parallel for schedule(runtime)
  for (int k = 2; k < (M - 2); k++)
  {
    for (int j = 2; j < (N - 2); j++)
    {
      for (int i = 2; i < (P - 2); i++)
      {
        b[(i + (j * P)) + (k * (P * N))] = ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((W[((0 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + (j * P)) + (k * (P * N))]) + (W[((1 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 2) * P)) + ((k - 2) * (P * N))])) + (W[((2 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 2) * P)) + ((k - 1) * (P * N))])) + (W[((3 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 2) * P)) + (k * (P * N))])) + (W[((4 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 2) * P)) + ((k + 1) * (P * N))])) + (W[((5 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 2) * P)) + ((k + 2) * (P * N))])) + (W[((6 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 1) * P)) + ((k - 2) * (P * N))])) + (W[((7 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 1) * P)) + ((k - 1) * (P * N))])) + (W[((8 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 1) * P)) + (k * (P * N))])) + (W[((9 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 1) * P)) + ((k + 1) * (P * N))])) + (W[((10 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j - 1) * P)) + ((k + 2) * (P * N))])) + (W[((11 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + (j * P)) + ((k - 2) * (P * N))])) + (W[((12 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + (j * P)) + ((k - 1) * (P * N))])) + (W[((13 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + (j * P)) + (k * (P * N))])) + (W[((14 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + (j * P)) + ((k + 1) * (P * N))])) + (W[((15 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + (j * P)) + ((k + 2) * (P * N))])) + (W[((16 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 1) * P)) + ((k - 2) * (P * N))])) + (W[((17 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 1) * P)) + ((k - 1) * (P * N))])) + (W[((18 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 1) * P)) + (k * (P * N))])) + (W[((19 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 1) * P)) + ((k + 1) * (P * N))])) + (W[((20 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 1) * P)) + ((k + 2) * (P * N))])) + (W[((21 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 2) * P)) + ((k - 2) * (P * N))])) + (W[((22 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 2) * P)) + ((k - 1) * (P * N))])) + (W[((23 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 2) * P)) + (k * (P * N))])) + (W[((24 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 2) * P)) + ((k + 1) * (P * N))])) + (W[((25 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 2) + ((j + 2) * P)) + ((k + 2) * (P * N))])) + (W[((26 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 2) * P)) + ((k - 2) * (P * N))])) + (W[((27 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 2) * P)) + ((k - 1) * (P * N))])) + (W[((28 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 2) * P)) + (k * (P * N))])) + (W[((29 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 2) * P)) + ((k + 1) * (P * N))])) + (W[((30 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 2) * P)) + ((k + 2) * (P * N))])) + (W[((31 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 1) * P)) + ((k - 2) * (P * N))])) + (W[((32 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 1) * P)) + ((k - 1) * (P * N))])) + (W[((33 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 1) * P)) + (k * (P * N))])) + (W[((34 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 1) * P)) + ((k + 1) * (P * N))])) + (W[((35 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j - 1) * P)) + ((k + 2) * (P * N))])) + (W[((36 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + (j * P)) + ((k - 2) * (P * N))])) + (W[((37 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + (j * P)) + ((k - 1) * (P * N))])) + (W[((38 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + (j * P)) + (k * (P * N))])) + (W[((39 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + (j * P)) + ((k + 1) * (P * N))])) + (W[((40 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + (j * P)) + ((k + 2) * (P * N))])) + (W[((41 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 1) * P)) + ((k - 2) * (P * N))])) + (W[((42 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 1) * P)) + ((k - 1) * (P * N))])) + (W[((43 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 1) * P)) + (k * (P * N))])) + (W[((44 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 1) * P)) + ((k + 1) * (P * N))])) + (W[((45 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 1) * P)) + ((k + 2) * (P * N))])) + (W[((46 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 2) * P)) + ((k - 2) * (P * N))])) + (W[((47 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 2) * P)) + ((k - 1) * (P * N))])) + (W[((48 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 2) * P)) + (k * (P * N))])) + (W[((49 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 2) * P)) + ((k + 1) * (P * N))])) + (W[((50 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i - 1) + ((j + 2) * P)) + ((k + 2) * (P * N))])) + (W[((51 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 2) * P)) + ((k - 2) * (P * N))])) + (W[((52 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 2) * P)) + ((k - 1) * (P * N))])) + (W[((53 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 2) * P)) + (k * (P * N))])) + (W[((54 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 2) * P)) + ((k + 1) * (P * N))])) + (W[((55 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 2) * P)) + ((k + 2) * (P * N))])) + (W[((56 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 1) * P)) + ((k - 2) * (P * N))])) + (W[((57 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 1) * P)) + ((k - 1) * (P * N))])) + (W[((58 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 1) * P)) + (k * (P * N))])) + (W[((59 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 1) * P)) + ((k + 1) * (P * N))])) + (W[((60 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j - 1) * P)) + ((k + 2) * (P * N))])) + (W[((61 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + (j * P)) + ((k - 2) * (P * N))])) + (W[((62 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + (j * P)) + ((k - 1) * (P * N))])) + (W[((63 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + (j * P)) + ((k + 1) * (P * N))])) + (W[((64 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + (j * P)) + ((k + 2) * (P * N))])) + (W[((65 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 1) * P)) + ((k - 2) * (P * N))])) + (W[((66 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 1) * P)) + ((k - 1) * (P * N))])) + (W[((67 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 1) * P)) + (k * (P * N))])) + (W[((68 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 1) * P)) + ((k + 1) * (P * N))])) + (W[((69 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 1) * P)) + ((k + 2) * (P * N))])) + (W[((70 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 2) * P)) + ((k - 2) * (P * N))])) + (W[((71 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 2) * P)) + ((k - 1) * (P * N))])) + (W[((72 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 2) * P)) + (k * (P * N))])) + (W[((73 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 2) * P)) + ((k + 1) * (P * N))])) + (W[((74 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[(i + ((j + 2) * P)) + ((k + 2) * (P * N))])) + (W[((75 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 2) * P)) + ((k - 2) * (P * N))])) + (W[((76 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 2) * P)) + ((k - 1) * (P * N))])) + (W[((77 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 2) * P)) + (k * (P * N))])) + (W[((78 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 2) * P)) + ((k + 1) * (P * N))])) + (W[((79 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 2) * P)) + ((k + 2) * (P * N))])) + (W[((80 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 1) * P)) + ((k - 2) * (P * N))])) + (W[((81 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 1) * P)) + ((k - 1) * (P * N))])) + (W[((82 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 1) * P)) + (k * (P * N))])) + (W[((83 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 1) * P)) + ((k + 1) * (P * N))])) + (W[((84 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j - 1) * P)) + ((k + 2) * (P * N))])) + (W[((85 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + (j * P)) + ((k - 2) * (P * N))])) + (W[((86 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + (j * P)) + ((k - 1) * (P * N))])) + (W[((87 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + (j * P)) + (k * (P * N))])) + (W[((88 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + (j * P)) + ((k + 1) * (P * N))])) + (W[((89 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + (j * P)) + ((k + 2) * (P * N))])) + (W[((90 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 1) * P)) + ((k - 2) * (P * N))])) + (W[((91 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 1) * P)) + ((k - 1) * (P * N))])) + (W[((92 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 1) * P)) + (k * (P * N))])) + (W[((93 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 1) * P)) + ((k + 1) * (P * N))])) + (W[((94 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 1) * P)) + ((k + 2) * (P * N))])) + (W[((95 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 2) * P)) + ((k - 2) * (P * N))])) + (W[((96 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 2) * P)) + ((k - 1) * (P * N))])) + (W[((97 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 2) * P)) + (k * (P * N))])) + (W[((98 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 2) * P)) + ((k + 1) * (P * N))])) + (W[((99 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 1) + ((j + 2) * P)) + ((k + 2) * (P * N))])) + (W[((100 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 2) * P)) + ((k - 2) * (P * N))])) + (W[((101 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 2) * P)) + ((k - 1) * (P * N))])) + (W[((102 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 2) * P)) + (k * (P * N))])) + (W[((103 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 2) * P)) + ((k + 1) * (P * N))])) + (W[((104 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 2) * P)) + ((k + 2) * (P * N))])) + (W[((105 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 1) * P)) + ((k - 2) * (P * N))])) + (W[((106 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 1) * P)) + ((k - 1) * (P * N))])) + (W[((107 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 1) * P)) + (k * (P * N))])) + (W[((108 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 1) * P)) + ((k + 1) * (P * N))])) + (W[((109 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j - 1) * P)) + ((k + 2) * (P * N))])) + (W[((110 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + (j * P)) + ((k - 2) * (P * N))])) + (W[((111 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + (j * P)) + ((k - 1) * (P * N))])) + (W[((112 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + (j * P)) + (k * (P * N))])) + (W[((113 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + (j * P)) + ((k + 1) * (P * N))])) + (W[((114 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + (j * P)) + ((k + 2) * (P * N))])) + (W[((115 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 1) * P)) + ((k - 2) * (P * N))])) + (W[((116 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 1) * P)) + ((k - 1) * (P * N))])) + (W[((117 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 1) * P)) + (k * (P * N))])) + (W[((118 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 1) * P)) + ((k + 1) * (P * N))])) + (W[((119 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 1) * P)) + ((k + 2) * (P * N))])) + (W[((120 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 2) * P)) + ((k - 2) * (P * N))])) + (W[((121 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 2) * P)) + ((k - 1) * (P * N))])) + (W[((122 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 2) * P)) + (k * (P * N))])) + (W[((123 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 2) * P)) + ((k + 1) * (P * N))])) + (W[((124 + (i * 125)) + (j * (125 * P))) + (k * ((125 * P) * N))] * a[((i + 2) + ((j + 2) * P)) + ((k + 2) * (P * N))]);
      }

    }

  }

}

