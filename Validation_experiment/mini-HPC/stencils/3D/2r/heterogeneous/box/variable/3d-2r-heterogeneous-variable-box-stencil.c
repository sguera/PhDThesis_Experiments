double a[M][N][P];
double b[M][N][P];
double W[M][N][P][125];

for(int k=2; k < M-2; k++){
for(int j=2; j < N-2; j++){
for(int i=2; i < P-2; i++){
b[k][j][i] = W[k][j][i][0] * a[k][j][i]
+ W[k][j][i][1] * a[k-2][j-2][i-2]
+ W[k][j][i][2] * a[k-1][j-2][i-2]
+ W[k][j][i][3] * a[k][j-2][i-2]
+ W[k][j][i][4] * a[k+1][j-2][i-2]
+ W[k][j][i][5] * a[k+2][j-2][i-2]
+ W[k][j][i][6] * a[k-2][j-1][i-2]
+ W[k][j][i][7] * a[k-1][j-1][i-2]
+ W[k][j][i][8] * a[k][j-1][i-2]
+ W[k][j][i][9] * a[k+1][j-1][i-2]
+ W[k][j][i][10] * a[k+2][j-1][i-2]
+ W[k][j][i][11] * a[k-2][j][i-2]
+ W[k][j][i][12] * a[k-1][j][i-2]
+ W[k][j][i][13] * a[k][j][i-2]
+ W[k][j][i][14] * a[k+1][j][i-2]
+ W[k][j][i][15] * a[k+2][j][i-2]
+ W[k][j][i][16] * a[k-2][j+1][i-2]
+ W[k][j][i][17] * a[k-1][j+1][i-2]
+ W[k][j][i][18] * a[k][j+1][i-2]
+ W[k][j][i][19] * a[k+1][j+1][i-2]
+ W[k][j][i][20] * a[k+2][j+1][i-2]
+ W[k][j][i][21] * a[k-2][j+2][i-2]
+ W[k][j][i][22] * a[k-1][j+2][i-2]
+ W[k][j][i][23] * a[k][j+2][i-2]
+ W[k][j][i][24] * a[k+1][j+2][i-2]
+ W[k][j][i][25] * a[k+2][j+2][i-2]
+ W[k][j][i][26] * a[k-2][j-2][i-1]
+ W[k][j][i][27] * a[k-1][j-2][i-1]
+ W[k][j][i][28] * a[k][j-2][i-1]
+ W[k][j][i][29] * a[k+1][j-2][i-1]
+ W[k][j][i][30] * a[k+2][j-2][i-1]
+ W[k][j][i][31] * a[k-2][j-1][i-1]
+ W[k][j][i][32] * a[k-1][j-1][i-1]
+ W[k][j][i][33] * a[k][j-1][i-1]
+ W[k][j][i][34] * a[k+1][j-1][i-1]
+ W[k][j][i][35] * a[k+2][j-1][i-1]
+ W[k][j][i][36] * a[k-2][j][i-1]
+ W[k][j][i][37] * a[k-1][j][i-1]
+ W[k][j][i][38] * a[k][j][i-1]
+ W[k][j][i][39] * a[k+1][j][i-1]
+ W[k][j][i][40] * a[k+2][j][i-1]
+ W[k][j][i][41] * a[k-2][j+1][i-1]
+ W[k][j][i][42] * a[k-1][j+1][i-1]
+ W[k][j][i][43] * a[k][j+1][i-1]
+ W[k][j][i][44] * a[k+1][j+1][i-1]
+ W[k][j][i][45] * a[k+2][j+1][i-1]
+ W[k][j][i][46] * a[k-2][j+2][i-1]
+ W[k][j][i][47] * a[k-1][j+2][i-1]
+ W[k][j][i][48] * a[k][j+2][i-1]
+ W[k][j][i][49] * a[k+1][j+2][i-1]
+ W[k][j][i][50] * a[k+2][j+2][i-1]
+ W[k][j][i][51] * a[k-2][j-2][i]
+ W[k][j][i][52] * a[k-1][j-2][i]
+ W[k][j][i][53] * a[k][j-2][i]
+ W[k][j][i][54] * a[k+1][j-2][i]
+ W[k][j][i][55] * a[k+2][j-2][i]
+ W[k][j][i][56] * a[k-2][j-1][i]
+ W[k][j][i][57] * a[k-1][j-1][i]
+ W[k][j][i][58] * a[k][j-1][i]
+ W[k][j][i][59] * a[k+1][j-1][i]
+ W[k][j][i][60] * a[k+2][j-1][i]
+ W[k][j][i][61] * a[k-2][j][i]
+ W[k][j][i][62] * a[k-1][j][i]
+ W[k][j][i][63] * a[k+1][j][i]
+ W[k][j][i][64] * a[k+2][j][i]
+ W[k][j][i][65] * a[k-2][j+1][i]
+ W[k][j][i][66] * a[k-1][j+1][i]
+ W[k][j][i][67] * a[k][j+1][i]
+ W[k][j][i][68] * a[k+1][j+1][i]
+ W[k][j][i][69] * a[k+2][j+1][i]
+ W[k][j][i][70] * a[k-2][j+2][i]
+ W[k][j][i][71] * a[k-1][j+2][i]
+ W[k][j][i][72] * a[k][j+2][i]
+ W[k][j][i][73] * a[k+1][j+2][i]
+ W[k][j][i][74] * a[k+2][j+2][i]
+ W[k][j][i][75] * a[k-2][j-2][i+1]
+ W[k][j][i][76] * a[k-1][j-2][i+1]
+ W[k][j][i][77] * a[k][j-2][i+1]
+ W[k][j][i][78] * a[k+1][j-2][i+1]
+ W[k][j][i][79] * a[k+2][j-2][i+1]
+ W[k][j][i][80] * a[k-2][j-1][i+1]
+ W[k][j][i][81] * a[k-1][j-1][i+1]
+ W[k][j][i][82] * a[k][j-1][i+1]
+ W[k][j][i][83] * a[k+1][j-1][i+1]
+ W[k][j][i][84] * a[k+2][j-1][i+1]
+ W[k][j][i][85] * a[k-2][j][i+1]
+ W[k][j][i][86] * a[k-1][j][i+1]
+ W[k][j][i][87] * a[k][j][i+1]
+ W[k][j][i][88] * a[k+1][j][i+1]
+ W[k][j][i][89] * a[k+2][j][i+1]
+ W[k][j][i][90] * a[k-2][j+1][i+1]
+ W[k][j][i][91] * a[k-1][j+1][i+1]
+ W[k][j][i][92] * a[k][j+1][i+1]
+ W[k][j][i][93] * a[k+1][j+1][i+1]
+ W[k][j][i][94] * a[k+2][j+1][i+1]
+ W[k][j][i][95] * a[k-2][j+2][i+1]
+ W[k][j][i][96] * a[k-1][j+2][i+1]
+ W[k][j][i][97] * a[k][j+2][i+1]
+ W[k][j][i][98] * a[k+1][j+2][i+1]
+ W[k][j][i][99] * a[k+2][j+2][i+1]
+ W[k][j][i][100] * a[k-2][j-2][i+2]
+ W[k][j][i][101] * a[k-1][j-2][i+2]
+ W[k][j][i][102] * a[k][j-2][i+2]
+ W[k][j][i][103] * a[k+1][j-2][i+2]
+ W[k][j][i][104] * a[k+2][j-2][i+2]
+ W[k][j][i][105] * a[k-2][j-1][i+2]
+ W[k][j][i][106] * a[k-1][j-1][i+2]
+ W[k][j][i][107] * a[k][j-1][i+2]
+ W[k][j][i][108] * a[k+1][j-1][i+2]
+ W[k][j][i][109] * a[k+2][j-1][i+2]
+ W[k][j][i][110] * a[k-2][j][i+2]
+ W[k][j][i][111] * a[k-1][j][i+2]
+ W[k][j][i][112] * a[k][j][i+2]
+ W[k][j][i][113] * a[k+1][j][i+2]
+ W[k][j][i][114] * a[k+2][j][i+2]
+ W[k][j][i][115] * a[k-2][j+1][i+2]
+ W[k][j][i][116] * a[k-1][j+1][i+2]
+ W[k][j][i][117] * a[k][j+1][i+2]
+ W[k][j][i][118] * a[k+1][j+1][i+2]
+ W[k][j][i][119] * a[k+2][j+1][i+2]
+ W[k][j][i][120] * a[k-2][j+2][i+2]
+ W[k][j][i][121] * a[k-1][j+2][i+2]
+ W[k][j][i][122] * a[k][j+2][i+2]
+ W[k][j][i][123] * a[k+1][j+2][i+2]
+ W[k][j][i][124] * a[k+2][j+2][i+2]
;
}
}
}
